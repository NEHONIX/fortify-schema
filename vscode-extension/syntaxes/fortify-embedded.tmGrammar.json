{
  "name": "Nehonix Fortify Schema Embedded",
  "scopeName": "source.ts.fortify",
  "injectionSelector": "L:source.ts -comment -string, L:source.tsx -comment -string",
  "patterns": [
    {
      "include": "#fortify-schema-strings"
    }
  ],
  "repository": {
    "fortify-schema-strings": {
      "patterns": [
        {
          "name": "string.quoted.double.fortify",
          "begin": "\"(?=.*(?:text|password|string|number|boolean|bool|date|any|unknown|email|url|url.https|url.http|url.web|url.dev|url.ftp|uuid|phone|slug|username|ip|json|json.fast|hexcolor|base64|jwt|semver|int|positive|negative|float|object|when|\\*\\?|\\||=\\w+|\\.\\$in|\\.\\$contains|\\.\\$startsWith|\\.\\$endsWith|\\.\\$between|\\.\\$exists|\\.\\$empty|\\.\\$null|\\[\\]|\\(\\d+,?\\d*\\)|\\(\\/.*?\\/[gimsuy]*\\)).*\")",
          "end": "\"",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.fortify"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.fortify"
            }
          },
          "patterns": [
            {
              "include": "#fortify-conditional-syntax"
            },
            {
              "include": "#fortify-basic-types"
            },
            {
              "include": "#fortify-format-types"
            },
            {
              "include": "#fortify-numeric-types"
            },
            {
              "include": "#fortify-constraints"
            },
            {
              "include": "#fortify-arrays"
            },
            {
              "include": "#fortify-optional"
            },
            {
              "include": "#fortify-unions"
            },
            {
              "include": "#fortify-constants"
            },
            {
              "include": "#fortify-methods"
            },
            {
              "include": "#fortify-operators"
            }
          ]
        },
        {
          "name": "string.quoted.single.fortify",
          "begin": "'(?=.*(?:text|password|string|number|boolean|bool|date|any|unknown|email|url|url.https|url.http|url.web|url.dev|url.ftp|uuid|phone|slug|username|ip|json|json.fast|hexcolor|base64|jwt|semver|int|positive|negative|float|object|when|\\*\\?|\\||=\\w+|\\.\\$in|\\.\\$contains|\\.\\$startsWith|\\.\\$endsWith|\\.\\$between|\\.\\$exists|\\.\\$empty|\\.\\$null|\\[\\]|\\(\\d+,?\\d*\\)|\\(\\/.*?\\/[gimsuy]*\\)).*')",
          "end": "'",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.fortify"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.fortify"
            }
          },
          "patterns": [
            {
              "include": "#fortify-conditional-syntax"
            },
            {
              "include": "#fortify-basic-types"
            },
            {
              "include": "#fortify-format-types"
            },
            {
              "include": "#fortify-numeric-types"
            },
            {
              "include": "#fortify-constraints"
            },
            {
              "include": "#fortify-arrays"
            },
            {
              "include": "#fortify-optional"
            },
            {
              "include": "#fortify-unions"
            },
            {
              "include": "#fortify-constants"
            },
            {
              "include": "#fortify-methods"
            },
            {
              "include": "#fortify-operators"
            }
          ]
        },
        {
          "name": "string.template.fortify",
          "begin": "`(?=.*(?:text|password|string|number|boolean|bool|date|any|unknown|email|url|url.https|url.http|url.web|url.dev|url.ftp|uuid|phone|slug|username|ip|json|json.fast|hexcolor|base64|jwt|semver|int|positive|negative|float|object|when|\\*\\?|\\||=\\w+|\\.\\$in|\\.\\$contains|\\.\\$startsWith|\\.\\$endsWith|\\.\\$between|\\.\\$exists|\\.\\$empty|\\.\\$null|\\[\\]|\\(\\d+,?\\d*\\)|\\(\\/.*?\\/[gimsuy]*\\)|\\$\\{[^}]*\\}).*`)",
          "end": "`",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.fortify"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.fortify"
            }
          },
          "patterns": [
            {
              "include": "#fortify-conditional-syntax"
            },
            {
              "include": "#fortify-basic-types"
            },
            {
              "include": "#fortify-format-types"
            },
            {
              "include": "#fortify-numeric-types"
            },
            {
              "include": "#fortify-constraints"
            },
            {
              "include": "#fortify-arrays"
            },
            {
              "include": "#fortify-optional"
            },
            {
              "include": "#fortify-unions"
            },
            {
              "include": "#fortify-constants"
            },
            {
              "include": "#fortify-methods"
            },
            {
              "include": "#fortify-operators"
            },
            {
              "include": "#fortify-template-expressions"
            }
          ]
        }
      ]
    },
    "fortify-conditional-syntax": {
      "patterns": [
        {
          "name": "meta.conditional.fortify.complete",
          "begin": "\\b(when)\\b",
          "end": "(?=\\s*[,}\\]]|$)",
          "beginCaptures": {
            "1": {
              "name": "keyword.control.fortify.when"
            }
          },
          "patterns": [
            {
              "name": "keyword.operator.fortify.conditional-then",
              "match": "\\*\\?"
            },
            {
              "name": "punctuation.separator.fortify.conditional-else",
              "match": ":"
            },
            {
              "include": "#fortify-conditional-condition"
            },
            {
              "include": "#fortify-basic-types"
            },
            {
              "include": "#fortify-format-types"
            },
            {
              "include": "#fortify-numeric-types"
            },
            {
              "include": "#fortify-constraints"
            },
            {
              "include": "#fortify-arrays"
            },
            {
              "include": "#fortify-unions"
            },
            {
              "include": "#fortify-constants"
            }
          ]
        },
        {
          "name": "keyword.operator.fortify.conditional-then",
          "match": "\\*\\?"
        },
        {
          "name": "punctuation.separator.fortify.conditional-else",
          "match": ":"
        }
      ]
    },
    "fortify-conditional-condition": {
      "patterns": [
        {
          "name": "meta.method-call.fortify.conditional",
          "match": "\\$([a-zA-Z_][a-zA-Z0-9_]*)\\s*\\(",
          "captures": {
            "1": {
              "name": "support.function.fortify.method"
            }
          }
        },
        {
          "name": "meta.property-access.fortify.conditional",
          "match": "([a-zA-Z_$][a-zA-Z0-9_$]*(?:\\.[a-zA-Z_$][a-zA-Z0-9_$]*)*(?:\\[(?:[\"'][^\"']*[\"']|\\d+)\\])*)\\.\\$([a-zA-Z_$][a-zA-Z0-9_$]*)\\(([^)]*)\\)",
          "captures": {
            "1": {
              "name": "variable.other.property.fortify"
            },
            "2": {
              "name": "support.function.fortify.method"
            },
            "3": {
              "name": "meta.function-call.arguments.fortify"
            }
          }
        },
        {
          "name": "meta.property-access.fortify.conditional",
          "match": "([a-zA-Z_$][a-zA-Z0-9_$.]*)\\.\\$([a-zA-Z_$][a-zA-Z0-9_$]*)\\(([^)]*)\\)",
          "captures": {
            "1": {
              "name": "variable.other.property.fortify"
            },
            "2": {
              "name": "support.function.fortify.method"
            },
            "3": {
              "name": "meta.function-call.arguments.fortify"
            }
          }
        },
        {
          "name": "variable.other.property.fortify",
          "match": "\\b([a-zA-Z_$][a-zA-Z0-9_$]*)(?=\\s*[.\\[=!<>~])"
        },
        {
          "name": "keyword.operator.fortify.comparison",
          "match": "(!=|>=|<=|!~|=|>|<|~)"
        },
        {
          "name": "keyword.operator.fortify.logical",
          "match": "(&&|\\|\\|)"
        },
        {
          "name": "keyword.operator.fortify.field-access",
          "match": "\\."
        },
        {
          "name": "punctuation.definition.bracket.fortify",
          "match": "[\\[\\]]"
        },
        {
          "name": "punctuation.definition.parameters.fortify",
          "match": "[\\(\\)]"
        },
        {
          "name": "string.quoted.single.fortify.condition",
          "match": "'[^']*'"
        },
        {
          "name": "string.quoted.double.fortify.condition",
          "match": "\"[^\"]*\""
        },
        {
          "name": "constant.numeric.fortify.condition",
          "match": "\\b\\d+(?:\\.\\d+)?\\b"
        }
      ]
    },
    "fortify-basic-types": {
      "patterns": [
        {
          "name": "string.quoted.double.fortify.basic-type",
          "match": "\\b(text|password|string|number|boolean|bool|date|any|unknown)\\b"
        }
      ]
    },
    "fortify-format-types": {
      "patterns": [
        {
          "name": "string.quoted.double.fortify.format-type",
          "match": "\\b(email|url|url.https|url.http|url.web|url.dev|url.ftp|uuid|phone|slug|username|ip|json|json.fast|hexcolor|base64|jwt|semver)\\b"
        }
      ]
    },
    "fortify-numeric-types": {
      "patterns": [
        {
          "name": "string.quoted.double.fortify.numeric-type",
          "match": "\\b(int|positive|negative|float)\\b"
        }
      ]
    },
    "fortify-constraints": {
      "patterns": [
        {
          "name": "punctuation.definition.fortify.constraint",
          "begin": "\\(",
          "end": "\\)",
          "patterns": [
            {
              "name": "string.regexp.fortify.constraint",
              "begin": "/",
              "end": "/([gimsuy]*)",
              "beginCaptures": {
                "0": {
                  "name": "punctuation.definition.string.begin.regexp.fortify"
                }
              },
              "endCaptures": {
                "0": {
                  "name": "punctuation.definition.string.end.regexp.fortify"
                },
                "1": {
                  "name": "keyword.other.regexp.flags.fortify"
                }
              },
              "patterns": [
                {
                  "name": "constant.character.escape.regexp.fortify",
                  "match": "\\\\."
                },
                {
                  "name": "constant.other.character-class.regexp.fortify",
                  "match": "\\[([^\\]\\\\]|\\\\.)*\\]"
                },
                {
                  "name": "keyword.operator.regexp.fortify",
                  "match": "[.*+?^${}()|\\[\\]]"
                }
              ]
            },
            {
              "name": "constant.numeric.fortify.constraint-value",
              "match": "\\d+(?:\\.\\d+)?"
            },
            {
              "name": "punctuation.separator.fortify.constraint",
              "match": ","
            }
          ]
        }
      ]
    },
    "fortify-arrays": {
      "patterns": [
        {
          "name": "punctuation.definition.fortify.array",
          "match": "\\[\\](\\([^)]*\\))?"
        }
      ]
    },
    "fortify-optional": {
      "patterns": [
        {
          "name": "punctuation.definition.fortify.optional",
          "match": "\\?"
        }
      ]
    },
    "fortify-unions": {
      "patterns": [
        {
          "name": "constant.other.fortify.union-separator",
          "match": "\\|"
        }
      ]
    },
    "fortify-constants": {
      "patterns": [
        {
          "name": "constant.other.fortify.constant-value",
          "match": "=\\w+"
        }
      ]
    },
    "fortify-methods": {
      "patterns": [
        {
          "name": "support.function.fortify.method",
          "match": "(\\.\\$(in|contains|startsWith|endsWith|between|exists|empty|null)\\b|\\[\"[^\"]*\"\\]\\.\\$(in|contains|startsWith|endsWith|between|exists|empty|null)\\b|\\['[^']*'\\]\\.\\$(in|contains|startsWith|endsWith|between|exists|empty|null)\\b|\\[\\d+\\]\\.\\$(in|contains|startsWith|endsWith|between|exists|empty|null)\\b)"
        },
        {
          "name": "punctuation.definition.fortify.method-call",
          "begin": "\\(",
          "end": "\\)",
          "patterns": [
            {
              "name": "string.unquoted.fortify.method-argument",
              "match": "[^,)]+"
            },
            {
              "name": "punctuation.separator.fortify.method-argument",
              "match": ","
            }
          ]
        }
      ]
    },
    "fortify-operators": {
      "patterns": [
        {
          "name": "keyword.operator.fortify.field-access",
          "match": "\\."
        }
      ]
    },
    "fortify-template-expressions": {
      "patterns": [
        {
          "name": "meta.embedded.expression.fortify",
          "begin": "\\$\\{",
          "end": "\\}",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.template-expression.begin.fortify"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.template-expression.end.fortify"
            }
          },
          "patterns": [
            {
              "include": "source.ts"
            }
          ]
        }
      ]
    }
  }
}